1. "
        
        # Ph√¢n t√≠ch RAM
        ram_tier = "
2. "
        
        # Th√™m ph√¢n t√≠ch kh·∫£ nƒÉng s·ª≠ d·ª•ng
        self.show_hardware_capability(hw_info)
        
        result_text = t("
3. "
        
        # T·∫°o capabilities d·ª±a tr√™n t·ªïng h·ª£p CPU + GPU + RAM
        capabilities = []
        
        if cpu_tier in ["
4. "
        cpu_upper = cpu_name.upper()
        
        import re
        
        # Ph√°t hi·ªán th·∫ø h·ªá Intel (t·∫•t c·∫£ t·ª´ Gen 1-15+)
        intel_gen = 0
        if "
5. "
    import time
    
    try:
        cpu_count = multiprocessing.cpu_count()
        cpu_msg = f'Ph√°t hi·ªán {cpu_count} l√µi CPU. ƒêang ƒëo baseline...' if CURRENT_LANG == "
6. " else f'Detected {cpu_count} CPU cores. Measuring baseline...'
        queue.put({'type': 'status', 'message': cpu_msg})
        
        # Enhanced baseline measurement
        time.sleep(1)
        baseline_cpu = psutil.cpu_percent(interval=1)
        baseline_temp = get_cpu_temperature()
        baseline_freq, max_freq = get_cpu_frequency()
        
        queue.put({'type': 'baseline', 'data': {
            'cpu_cores': cpu_count,
            'baseline_cpu': baseline_cpu,
            'baseline_temp': baseline_temp,
            'baseline_freq': baseline_freq,
            'max_freq': max_freq
        }})
        
        # Start stress test
        stress_msg = 'B·∫Øt ƒë·∫ßu stress test v·ªõi t·∫£i 100%...' if CURRENT_LANG == "
7. " in cpu_upper:
            # C√°ch 1: i3-12400, i5-10400, i7-8750H
            gen_match = re.search(r'I[3579]-?(\d{1,2})\d{3}', cpu_upper)
            if gen_match:
                intel_gen = int(gen_match.group(1))
            else:
                # C√°ch 2: "
8. " in line:
                    ram_match = re.search(r'([\d.]+)\s*GB', line)
                    ram_gb = float(ram_match.group(1)) if ram_match else 0
        
        # D√πng h√†m chung t·ª´ HardwareFingerprintStep
        hw_step = HardwareFingerprintStep(None)
        capabilities = hw_step._analyze_capabilities(cpu_name, gpu_name, ram_gb)
        
        return capabilities, cpu_name
    
    def display_summary(self, results):
        for widget in self.action_frame.winfo_children(): 
            widget.destroy()
        
        self.create_simple_summary(results)
    
    def create_simple_summary(self, results):
        # Use action_frame directly (already scrollable)
        scroll_frame = self.action_frame
        
        # Header with logo - TO, R·ªòNG, ƒê·∫∏P
        header_frame = ctk.CTkFrame(scroll_frame, fg_color=Theme.ACCENT, corner_radius=12, height=120)
        header_frame.pack(fill="
9. ")

    def start_listening(self):
        try:
            self.listening = True
            # Ch·∫∑n ch·ªâ Print Screen, kh√¥ng ch·∫∑n t·∫•t c·∫£
            keyboard.hook(self.on_key_event, suppress=False)
            
            # Th√™m hook ri√™ng cho Print Screen
            keyboard.block_key('print screen')
        except Exception as e:
            self.listening = False
            if "
10. ")
        
        # Control buttons ·ªü b√™n ph·∫£i - tƒÉng k√≠ch th∆∞·ªõc
        controls_frame = ctk.CTkFrame(self.header, fg_color="
11. ")
        
        # Quick stats - TO H∆†N
        stats_frame = ctk.CTkFrame(scroll_frame, fg_color=Theme.FRAME, corner_radius=12, height=140)
        stats_frame.pack(fill="
12. ")
        
        # Tr√≠ch xu·∫•t RAM GB
        ram_match = re.search(r'([\d.]+)\s*GB', ram_str)
        ram_gb = float(ram_match.group(1)) if ram_match else 0
        
        capabilities = self._analyze_capabilities(cpu_name, gpu_name, ram_gb)
        
        if not capabilities:
            return
        
        # Hi·ªÉn th·ªã capabilities
        cap_frame = ctk.CTkFrame(self.action_frame, fg_color="
13. ")
        except:
            pass
        
        # Th√¥ng tin c·ªôt 2 - c√≥ d·ªãch
        self.title_label = ctk.CTkLabel(left_frame, text="
14. ")
        main_frame.grid_columnconfigure(0, weight=1)
        main_frame.grid_rowconfigure(1, weight=1)
        
        # Lo·∫°i b·ªè ho√†n to√†n kh·ªëi n√†y - th√¥ng tin ƒë√£ ƒë∆∞·ª£c di chuy·ªÉn l√™n header
        
        # App introduction section ƒë∆°n gi·∫£n
        intro_frame = ctk.CTkFrame(main_frame, fg_color="
15. ")
        queue.put({'type': 'status', 'message': stress_msg})
        
        running = True
        
        while running and (time.time() - start_time < duration):
            dt = clock.tick(60) / 1000.0
            current_time = time.time() - start_time
            progress = current_time / duration
            
            for event in pygame.event.get():
                if event.type == pygame.QUIT or (event.type == pygame.KEYDOWN and event.key == pygame.K_ESCAPE):
                    running = False
                    stop_msg = 'Test b·ªã d·ª´ng b·ªüi ng∆∞·ªùi d√πng (ESC)' if CURRENT_LANG == "
16. ")
        return parts

# Global secure executor
_secure_executor = SecureCommandExecutor()

# ============================================================================
# AI ANALYZER - Model-specific warnings
# ============================================================================
class LaptopAIDiagnoser:
    def __init__(self):
        self.model_warnings = {
            'thinkpad x1': '‚ö†Ô∏è ThinkPad X1: Ki·ªÉm tra k·ªπ b·∫£n l·ªÅ - d·ªÖ b·ªã l·ªèng',
            'thinkpad t480': '‚ö†Ô∏è T480: Pin c√≥ th·ªÉ b·ªã chai nhanh',
            'xps': '‚ö†Ô∏è Dell XPS: D·ªÖ b·ªã coil whine v√† throttling',
            'macbook pro 2016': '‚ö†Ô∏è MacBook Pro 2016-2017: B√†n ph√≠m butterfly d·ªÖ h·ªèng',
            'pavilion': '‚ö†Ô∏è HP Pavilion: Qu·∫°t t·∫£n nhi·ªát d·ªÖ b·ªã b·ª•i',
            'rog': '‚ö†Ô∏è ASUS ROG: GPU c√≥ th·ªÉ b·ªã artifacts',
        }
    
    def analyze_model(self, model_name):
        model_lower = model_name.lower()
        for key, warning in self.model_warnings.items():
            if key in model_lower:
                return warning
        return None

_ai_diagnoser = LaptopAIDiagnoser()

# ============================================================================
# AUDIO WORKER - stereo_test.mp3 integration
# ============================================================================
def play_stereo_test_audio(status_callback=None):
    if not pygame:
        return False
    
    stereo_test_path = os.path.join(os.path.dirname(__file__), "
17. ")
        self.header.grid_columnconfigure(1, weight=1)
        
        # Layout table: Logo c·ªôt 1, th√¥ng tin c·ªôt 2
        left_frame = ctk.CTkFrame(self.header, fg_color="
18. "))
        self.state('zoomed')
        self.minsize(1400, 900)
        
        self.icon_manager = IconManager()
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.grid_rowconfigure(1, weight=20)
        self.current_main_frame = None
        self.all_results = {}

        # Header v·ªõi layout m·ªõi
        self.header = ctk.CTkFrame(self, fg_color="
19. "), font=Theme.BODY_FONT)
        self.recording_status.pack(pady=10)
        
        self.show_result_choices()
    
    def play_test_music(self):
        def test_audio():
            self.music_playing = True
            
            # Import audio worker
            try:
                from worker_audio import run_audio_test
                
                def status_update(msg):
                    if self.music_playing:
                        self.recording_status.configure(text=msg)
                
                # Ch·∫°y audio test v·ªõi stereo_test.mp3
                success = run_audio_test(status_update)
                
                if success:
                    self.recording_status.configure(text=t("
20. "), font=Theme.SUBHEADING_FONT, text_color=Theme.ACCENT).pack(pady=15)
        
        # C√°ch v√†o BIOS
        access_frame = ctk.CTkFrame(checklist_frame, fg_color=Theme.BACKGROUND)
        access_frame.pack(fill="
21. "), font=Theme.SUBHEADING_FONT, text_color=Theme.ACCENT).pack(pady=15)
        
        # V·ªè m√°y & B·∫£n l·ªÅ
        section1 = ctk.CTkFrame(checklist_frame, fg_color=Theme.BACKGROUND)
        section1.pack(fill="
22. "), text_color=color).pack(pady=(0, 15))
        
        # Overall assessment - TO H∆†N
        assessment_frame = ctk.CTkFrame(scroll_frame, corner_radius=12, height=100)
        assessment_frame.pack(fill="
23. ", True, (255, 255, 255))
            
            screen.blit(elapsed_text, (10, 10))
            screen.blit(fps_text, (10, 40))
            screen.blit(particles_text, (10, 70))
            screen.blit(progress_text, (10, 100))
            
            # Progress bar
            bar_width = 300
            bar_height = 10
            bar_x = 10
            bar_y = 200
            pygame.draw.rect(screen, (50, 50, 50), (bar_x, bar_y, bar_width, bar_height))
            pygame.draw.rect(screen, (0, 255, 0), (bar_x, bar_y, int(bar_width * progress), bar_height))

            pygame.display.flip()
            
            if frame_count % 30 == 0:  # Update every 30 frames for smoother charts
                queue.put({
                    'type': 'update',
                    'progress': progress,
                    'fps': fps,
                    'particles': len(particles),
                    'frame_count': frame_count
                })

        pygame.quit()
        
        # Calculate results
        avg_fps = sum(fps_readings) / len(fps_readings) if fps_readings else 0
        min_fps = min(fps_readings) if fps_readings else 0
        max_fps = max(fps_readings) if fps_readings else 0
        
        result_data = {
            'duration': current_time,
            'total_frames': frame_count,
            'average_fps': round(avg_fps, 2),
            'min_fps': round(min_fps, 2),
            'max_fps': round(max_fps, 2),
            'stable_performance': min_fps > 30 and avg_fps > 45
        }
        
        queue.put({'type': 'result', 'data': result_data})
        queue.put({'type': 'done'})

    except Exception as e:
        try:
            pygame.quit()
        except:
            pass
        gpu_error_msg = f'L·ªói GPU stress test: {str(e)}' if CURRENT_LANG == "
24. ", padx=10, pady=1)
        
        # B·∫£o m·∫≠t kh√°c
        security_frame = ctk.CTkFrame(checklist_frame, fg_color="
25. ", padx=25, pady=1)
        
        # C·∫£nh b√°o m·∫≠t kh·∫©u BIOS
        password_warning = ctk.CTkFrame(checklist_frame, fg_color="
26. ", padx=25, pady=1)
        
        # C·ªïng k·∫øt n·ªëi
        section2 = ctk.CTkFrame(checklist_frame, fg_color=Theme.BACKGROUND)
        section2.pack(fill="
27. ", padx=25, pady=1)
        
        # Hi·ªáu nƒÉng CPU
        cpu_frame = ctk.CTkFrame(checklist_frame, fg_color=Theme.BACKGROUND)
        cpu_frame.pack(fill="
28. ", padx=25, pady=1)
        
        # ThinkPad ƒë·∫∑c bi·ªát
        thinkpad_frame = ctk.CTkFrame(checklist_frame, fg_color="
29. ", padx=25, pady=1)
        
        # ·ªêc v√≠t & Tem
        section3 = ctk.CTkFrame(checklist_frame, fg_color=Theme.BACKGROUND)
        section3.pack(fill="
30. ", padx=Theme.PADDING, pady=Theme.PADDING)
        left_frame.grid_columnconfigure(1, weight=1)
        
        # Logo c·ªôt 1 - k√≠ch th∆∞·ªõc b·∫±ng 5 d√≤ng th√¥ng tin
        try:
            logo_img = ctk.CTkImage(Image.open(asset_path("
31. ", pady=10)
            
            status = drive_data.get('Tr·∫°ng th√°i', 'Kh√¥ng r√µ')
            good_text = t("
32. "BIOS ch·ª©a c√°c c√†i ƒë·∫∑t n·ªÅn t·∫£ng. Ki·ªÉm tra ƒë·ªÉ ƒë·∫£m b·∫£o hi·ªáu nƒÉng t·ªëi ∆∞u v√† kh√¥ng b·ªã kh√≥a b·ªüi c√°c t√≠nh nƒÉng doanh nghi·ªáp."
33. "B√ÅO C√ÅO KI·ªÇM TRA LAPTOP"
34. "B√†i test s·∫Ω t·∫°o ra m·ªôt c·ª≠a s·ªï ƒë·ªì h·ªça n·∫∑ng trong 60 gi√¢y. H√£y quan s√°t c√≥ hi·ªán t∆∞·ª£ng ch·ªõp gi·∫≠t, s·ªçc ngang, hay c√°c ƒë·ªëm m√†u l·∫° kh√¥ng?"
35. "B√¨nh th∆∞·ªùng"
36. "B·∫£o m·∫≠t & ƒê·ªãnh danh"
37. "B·∫Øt ƒë·∫ßu"
38. "CPU kh√¥ng ·ªïn ƒë·ªãnh"
39. "CPU ·ªïn ƒë·ªãnh"
40. "Chuy√™n gia"
41. "Ch·ªçn ch·∫ø ƒë·ªô"
42. "Click tr√°i: {self.mouse_clicks['left']}, Click ph·∫£i: {self.mouse_clicks['right']}"
43. "Copy th√†nh c√¥ng"
44. "C√îNG C·ª§ CHUY√äN NGHI·ªÜP B·ªî SUNG"
45. "C√†i ƒë·∫∑t ch√≠nh x√°c"
46. "C√°ch th·ª±c hi·ªán:"
47. "C√≥ l·ªói"
48. "C√≥ m·ªôt s·ªë v·∫•n ƒë·ªÅ nh·ªè, c·∫ßn ki·ªÉm tra k·ªπ tr∆∞·ªõc khi quy·∫øt ƒë·ªãnh."
49. "C√≥ v·∫•n ƒë·ªÅ"
50. "C√≥ v·∫•n ƒë·ªÅ v·ªõi BIOS"
51. "C√≥ ·ªï c·ª©ng l·ªói"
52. "C√¥ng su·∫•t"
53. "C∆° b·∫£n"
54. "D·ª´ng"
55. "D·ª´ng Test"
56. "Ghi √¢m"
57. "Giao di·ªán"
58. "Gi√°m s√°t h·ªá th·ªëng"
59. "Gi√°m s√°t nhi·ªát ƒë·ªô v√† c·∫£m bi·∫øn"
60. "Hi·ªáu nƒÉng"
61. "Ho·∫°t ƒë·ªông t·ªët"
62. "H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG C√îNG C·ª§"
63. "H·ªá th·ªëng √¢m thanh c√≥ v·∫•n ƒë·ªÅ"
64. "H·ªá th·ªëng √¢m thanh t·ªët"
65. "Kh√¥ng c√≥ v·∫•n ƒë·ªÅ"
66. "Kh√¥ng ho·∫°t ƒë·ªông"
67. "Kh√¥ng r√µ"
68. "Kh√¥ng th·ªÉ b·∫Øt s·ª± ki·ªán b√†n ph√≠m do thi·∫øu quy·ªÅn Admin/root. Vui l√≤ng ch·∫°y l·∫°i ·ª©ng d·ª•ng v·ªõi quy·ªÅn qu·∫£n tr·ªã vi√™n."
69. "Kh√¥ng ·ªïn ƒë·ªãnh"
70. "Ki·ªÉm Tra C√†i ƒê·∫∑t BIOS"
71. "Ki·ªÉm tra RAM l·ªói (USB boot)"
72. "Ki·ªÉm tra S.M.A.R.T ·ªï c·ª©ng chi ti·∫øt"
73. "Ki·ªÉm tra b·∫£n quy·ªÅn Windows"
74. "Ki·ªÉm tra m·∫°ng"
75. "Ki·ªÉm tra th√¥ng tin ph·∫ßn c·ª©ng t·ª´ BIOS"
76. "K·∫øt n·ªëi m·∫°ng"
77. "LAPTOP C√ì V·∫§N ƒê·ªÄ NGHI√äM TR·ªåNG"
78. "LAPTOP C·∫¶N CH√ö √ù"
79. "LAPTOP T√åNH TR·∫†NG T·ªêT"
80. "Laptop ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh, c√≥ th·ªÉ mua v·ªõi gi√° h·ª£p l√Ω."
81. "LaptopTester Pro - Ki·ªÉm tra laptop to√†n di·ªán"
82. "L·ªánh c√†i ƒë·∫∑t:"
83. "L·ªói Worker"
84. "L·ªói: {e}"
85. "M√†n h√¨nh b√¨nh th∆∞·ªùng"
86. "M·ªôt CPU qu√° nhi·ªát s·∫Ω t·ª± gi·∫£m hi·ªáu nƒÉng (throttling) g√¢y gi·∫≠t lag. B√†i test n√†y s·∫Ω ƒë·∫©y CPU l√™n 100% t·∫£i ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng t·∫£n nhi·ªát."
87. "Ng√¥n ng·ªØ"
88. "Nhi·ªÅu l·ªói ph√°t hi·ªán, kh√¥ng khuy·∫øn ngh·ªã mua ho·∫∑c c·∫ßn gi·∫£m gi√° m·∫°nh."
89. "Nhi·ªát ƒë·ªô & Hi·ªáu nƒÉng"
90. "Nh·∫•n 'B·∫Øt ƒë·∫ßu Test' trong 2-5 ph√∫t. Theo d√µi nhi·ªát ƒë·ªô. N·∫øu nhi·ªát ƒë·ªô ·ªïn ƒë·ªãnh d∆∞·ªõi 95¬∞C v√† kh√¥ng c√≥ hi·ªán t∆∞·ª£ng treo m√°y, h·ªá th·ªëng t·∫£n nhi·ªát ho·∫°t ƒë·ªông t·ªët."
91. "Ph√°t"
92. "Ph√¢n t√≠ch kh·∫£ nƒÉng s·ª≠ d·ª•ng d·ª±a tr√™n th√¥ng tin ph·∫ßn c·ª©ng t·ª´ BIOS"
93. "Ph√¢n t√≠ch pin ho√†n th√†nh"
94. "Ph√¢n t√≠ch to√†n di·ªán t√¨nh tr·∫°ng ph·∫ßn c·ª©ng"
95. "Ph·∫ßn c·ª©ng"
96. "Pin t·ªët"
97. "Stress test GPU chuy√™n nghi·ªáp"
98. "S·∫µn s√†ng"
99. "S·ª©c kh·ªèe pin"
100. "S·ª©c kh·ªèe ·ªï c·ª©ng (S.M.A.R.T)"
101. "TH√îNG TIN B·∫¢O M·∫¨T"
102. "Test ho√†n th√†nh"
103. "Test ri√™ng l·∫ª"
104. "Thi·∫øt b·ªã nh·∫≠p t·ªët"
105. "Tho√°t"
106. "Th√¥ng tin CPU, RAM, Mainboard"
107. "Th√¥ng tin card ƒë·ªì h·ªça chi ti·∫øt"
108. "Th√¥ng tin c·∫•u h√¨nh h·ªá th·ªëng"
109. "Th·ª±c thi command an to√†n"
110. "Th·ª±c thi command v·ªõi validation"
111. "Ti·∫øp"
112. "Ti·∫øp t·ª•c"
113. "Trang ch·ªß"
114. "Tr∆∞·ªõc"
115. "Tr·∫Øng"
116. "T·∫°i sao c·∫ßn test?"
117. "T·∫£i t·ª´ trang ch·ªß"
118. "T·∫•t c·∫£ ƒë·ªÅu t·ªët"
119. "T·∫ßn s·ªë"
120. "T·ªëc ƒë·ªô"
121. "T·ªëc ƒë·ªô t·ªët"
122. "T·ªëi"
123. "T·ªïng Test"
124. "T·ªïng k·∫øt"
125. "T·ªïng quan"
126. "T·ª∑ L·ªá ƒê·∫°t"
127. "Webcam c√≥ l·ªói"
128. "Webcam ho·∫°t ƒë·ªông t·ªët"
129. "Webcam test s·∫µn s√†ng"
130. "XU·∫§T B√ÅO C√ÅO"
131. "Xanh D∆∞∆°ng"
132. "Xanh L√°"
133. "Xem checklist b√™n d∆∞·ªõi ƒë·ªÉ ki·ªÉm tra t·ª´ng m·ª•c trong BIOS"
134. "Xu·∫•t Excel"
135. "Xu·∫•t PDF"
136. "X√≥a v·∫øt v·∫Ω"
137. "k√≠ch ho·∫°t vƒ©nh vi·ªÖn"
138. "s·∫Ω h·∫øt h·∫°n"
139. "√Çm thanh r√µ r√†ng"
140. "ƒêang ch·∫°y"
141. "ƒêang ki·ªÉm tra"
142. "ƒêang test"
143. "ƒêang t·∫£i"
144. "ƒê√£ copy b√°o c√°o v√†o clipboard!"
145. "ƒê√£ hi·ªÉn th·ªã checklist"
146. "ƒê·ªÉ ki·ªÉm tra s√¢u h∆°n, h√£y s·ª≠ d·ª•ng c√°c c√¥ng c·ª• chuy√™n nghi·ªáp sau:"
147. "·ªîn ƒë·ªãnh"
148. "‚ö†Ô∏è Pin Trung B√¨nh (60-80%)"
149. "‚úì Pin T·ªët"
150. "‚úì Pin T·ªët (>80%)"
151. "‚ùå L·ªói camera: {e}"
152. "‚ùå Pin Y·∫øu (<60%)"
153. "üéµ Ph√°t stereo_test.mp3 ({elapsed}s)"
154. "üìä T·ªëc ƒë·ªô: {speed_mbps:.1f} Mbps ({downloaded/1024/1024:.1f}MB/{duration:.1f}s)"
155. "üì∑ ƒê·ªô ph√¢n gi·∫£i t·ªëi ƒëa: {actual_width}x{actual_height}"
